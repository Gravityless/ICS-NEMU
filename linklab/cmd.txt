https://zhuanlan.zhihu.com/p/332264644

gcc -m32 -no-pie -o linkbomb main.o phase1.o

objdump -d phase1.o > phase1.d

gcc -no-pie -o linkbomb main.o phase3.o phase3_patch.o

phase3 cookie: lrycgvafb

phase4 cookie: YPDWQKXHO (59 50 44 57 51 4b 58 48 4f)
---ã€‹                     100 64 16 92 68 44 96 32 60

phase5 
Relocation section '.rel.text' at offset 0x718 contains 23 entries:
 Offset     Info    Type            Sym.Value  Sym. Name
00000000  00000000 R_386_NONE
0000006e  00000501 R_386_32          00000000   .rodata
00000000  00000000 R_386_NONE
00000093  00000d01 R_386_32          00000020   AJGAgX
00000000  00000000 R_386_NONE
000000b6  00000d01 R_386_32          00000020   AJGAgX
000000c5  00000d01 R_386_32          00000020   AJGAgX
00000000  00000000 R_386_NONE
00000000  00000000 R_386_NONE
00000100  00000e01 R_386_32          0000003c   yNJXAB
00000109  00000f02 R_386_PC32        00000056   transform_code
00000111  00000e01 R_386_32          0000003c   yNJXAB
00000131  00001302 R_386_PC32        00000000   strlen
00000155  00001101 R_386_32          00000080   BBGNXr
0000015b  00000e01 R_386_32          0000003c   yNJXAB
000001b9  00001302 R_386_PC32        00000000   strlen
000001dd  00001101 R_386_32          00000080   BBGNXr
000001e3  00000e01 R_386_32          0000003c   yNJXAB
0000023f  00001002 R_386_PC32        000000e8   generate_code
00000247  00001501 R_386_32          00000040   encoder
0000024f  00000c01 R_386_32          00000030   vNnkkfKL
00000000  00000000 R_386_NONE
00000261  00001702 R_386_PC32        00000000   puts

Relocation section '.rel.data' at offset 0x7d0 contains 4 entries:
 Offset     Info    Type            Sym.Value  Sym. Name
0000002c  00000501 R_386_32          00000000   .rodata
00000000  00000000 R_386_NONE
00000044  00001401 R_386_32          000001ac   encode_2
00000048  00001601 R_386_32          00000233   do_phase


phase6
Relocation section '.rel.text' at offset 0xa00 contains 35 entries:
 Offset     Info    Type            Sym.Value  Sym. Name
00000007  00001902 R_386_PC32        00000000   __x86.get_pc_thunk.ax
0000000c  00001a0a R_386_GOTPC       00000000   _GLOBAL_OFFSET_TABLE_
00000055  00001902 R_386_PC32        00000000   __x86.get_pc_thunk.ax
00000000  00000000 R_386_NONE
00000060  00001d2b R_386_GOT32X      00000020   AJGAgX
0000007c  00000509 R_386_GOTOFF      00000000   .rodata
00000000  00000000 R_386_NONE
000000a1  00001d2b R_386_GOT32X      00000020   AJGAgX
00000000  00000000 R_386_NONE
000000c8  00001d2b R_386_GOT32X      00000020   AJGAgX
000000d9  00001d2b R_386_GOT32X      00000020   AJGAgX
00000000  00000000 R_386_NONE
0000010c  00002102 R_386_PC32        00000000   __x86.get_pc_thunk.bx
00000000  00000000 R_386_NONE
00000000  00000000 R_386_NONE
0000012c  00001e2b R_386_GOT32X      000000c0   yNJXAB
0000013a  00001f04 R_386_PLT32       00000051   transform_code
00000145  00001e2b R_386_GOT32X      000000c0   yNJXAB
00000165  00002102 R_386_PC32        00000000   __x86.get_pc_thunk.bx
0000016b  00001a0a R_386_GOTPC       00000000   _GLOBAL_OFFSET_TABLE_
00000176  00002404 R_386_PLT32       00000000   strlen
00000199  0000222b R_386_GOT32X      00000080   BBGNXr
00000000  00000000 R_386_NONE
00000201  00002102 R_386_PC32        00000000   __x86.get_pc_thunk.bx
00000207  00001a0a R_386_GOTPC       00000000   _GLOBAL_OFFSET_TABLE_
00000212  00002404 R_386_PLT32       00000000   strlen
00000000  00000000 R_386_NONE
0000023f  00001e2b R_386_GOT32X      000000c0   yNJXAB
0000029c  00002102 R_386_PC32        00000000   __x86.get_pc_thunk.bx
000002a2  00001a0a R_386_GOTPC       00000000   _GLOBAL_OFFSET_TABLE_
000002af  00002004 R_386_PLT32       00000104   generate_code
000002b8  0000262b R_386_GOT32X      00000000   encoder
000002c4  00001c2b R_386_GOT32X      000000b4   vNnkkfKL
000002d3  00001c2b R_386_GOT32X      000000b4   vNnkkfKL
000002d9  00002804 R_386_PLT32       00000000   puts
